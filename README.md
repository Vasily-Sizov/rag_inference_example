# RAG Infrastructure Test Stand

> ‚ö†Ô∏è **–í–∞–∂–Ω–æ**: –≠—Ç–æ **–Ω–µ —Ä–µ–∞–ª—å–Ω–∞—è RAG-—Å–∏—Å—Ç–µ–º–∞**, –∞ —Ç–µ—Å—Ç–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —Å –æ—á–µ—Ä–µ–¥—è–º–∏ —Å–æ–æ–±—â–µ–Ω–∏–π, –≤–µ–∫—Ç–æ—Ä–Ω—ã–º –ø–æ–∏—Å–∫–æ–º –∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –∑–∞–ø—Ä–æ—Å–æ–≤.

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Ç–µ—Å—Ç–æ–≤—ã–π —Å—Ç–µ–Ω–¥ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π RAG-–ø–æ–¥–æ–±–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã. –°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∑–∞–≥–ª—É—à–∫–∏ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤–µ–∫—Ç–æ—Ä–æ–≤ –∏ –Ω–µ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

**–û—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã:
- –û—á–µ—Ä–µ–¥–∏ —Å–æ–æ–±—â–µ–Ω–∏–π (Artemis, Redis)
- –í–µ–∫—Ç–æ—Ä–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (OpenSearch)
- –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
- –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–°–∏—Å—Ç–µ–º–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ 9 —Å–µ—Ä–≤–∏—Å–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –≤ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö:

### –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- **artemis** - –ë—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π (AMQP)
- **redis** - –û—á–µ—Ä–µ–¥–∏ –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
- **opensearch** - –í–µ–∫—Ç–æ—Ä–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –°–µ—Ä–≤–∏—Å—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **file_service** - HTTP-—Å–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–∞–º–∏
- **artemis_chat_email** - –ö–æ–Ω—Å—å—é–º–µ—Ä –æ—á–µ—Ä–µ–¥–µ–π chat.in/email.in
- **translator_service** - –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π –≤ Redis
- **rag_stub** - –í–æ—Ä–∫–µ—Ä –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ RAG-–∑–∞–ø—Ä–æ—Å–æ–≤
- **indexer_stub** - –°–µ—Ä–≤–∏—Å –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- **artemis_indexer** - –ö–æ–Ω—Å—å—é–º–µ—Ä –æ—á–µ—Ä–µ–¥–∏ index.in

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# 1. –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker compose up --build

# 2. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–ø—É—Å–∫–∞ (30-60 —Å–µ–∫—É–Ω–¥)
docker compose ps

# 3. –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
python test_pipeline.py
```

## üìä Pipeline

–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç 3 –æ—Å–Ω–æ–≤–Ω—ã—Ö pipeline:

1. **INDEX** - –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏–∑ `/storage` –≤ OpenSearch
2. **CHAT** - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏–∑ —á–∞—Ç–∞ (–≤–µ–∫—Ç–æ—Ä ‚Üí –ø–æ–∏—Å–∫ ‚Üí –æ—Ç–≤–µ—Ç)
3. **EMAIL** - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏–∑ email (–≤–µ–∫—Ç–æ—Ä ‚Üí –ø–æ–∏—Å–∫ ‚Üí –æ—Ç–≤–µ—Ç)

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **[architecture.md](architecture.md)** - –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã, —Å–µ—Ä–≤–∏—Å–æ–≤ –∏ –ø–æ—Ç–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- **[manual_test_readme.md](manual_test_readme.md)** - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Ä—É—á–Ω–æ–º—É —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –∏ –ø—Ä–æ–≤–µ—Ä–∫–µ —Å–∏—Å—Ç–µ–º—ã

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### Artemis (–≤–µ–±-–∫–æ–Ω—Å–æ–ª—å)
- URL: http://localhost:8161
- –õ–æ–≥–∏–Ω/–ü–∞—Ä–æ–ª—å: `artemis` / `artemis`

### OpenSearch
- URL: http://localhost:9200
- –ü–æ–∏—Å–∫: http://localhost:9200/docs/_search?pretty=true

### Redis
```bash
docker compose exec redis redis-cli
LLEN chats  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—á–µ—Ä–µ–¥–∏
```

## ‚öôÔ∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Python 3.11**
- **FastAPI** - REST API —Å–µ—Ä–≤–∏—Å—ã
- **Apache ActiveMQ Artemis** - –ë—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π (AMQP)
- **Redis** - –û—á–µ—Ä–µ–¥–∏ –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
- **OpenSearch** - –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ (KNN)
- **Docker Compose** - –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤

## ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- **–í–µ–∫—Ç–æ—Ä—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∑–∞–≥–ª—É—à–∫–æ–π** (`embeddings_stub`) - —Å–ª—É—á–∞–π–Ω—ã–µ —á–∏—Å–ª–∞
- **–ù–µ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–æ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**
- **–¢–µ—Å—Ç–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞** –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- **–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –í—Å–µ pipeline
python test_pipeline.py

# –û—Ç–¥–µ–ª—å–Ω—ã–µ pipeline
python test_pipeline.py index
python test_pipeline.py chat
python test_pipeline.py email
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
rag_stend/
‚îú‚îÄ‚îÄ artemis_chat_email/    # –ö–æ–Ω—Å—å—é–º–µ—Ä chat.in/email.in
‚îú‚îÄ‚îÄ artemis_indexer/       # –ö–æ–Ω—Å—å—é–º–µ—Ä index.in
‚îú‚îÄ‚îÄ file_service/          # HTTP-—Å–µ—Ä–≤–∏—Å —Ñ–∞–π–ª–æ–≤
‚îú‚îÄ‚îÄ indexer_stub/          # –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ rag_stub/              # RAG-–≤–æ—Ä–∫–µ—Ä
‚îú‚îÄ‚îÄ translator_service/    # –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä
‚îú‚îÄ‚îÄ storage/               # –§–∞–π–ª—ã –¥–ª—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ docker-compose.yml     # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤
‚îú‚îÄ‚îÄ architecture.md       # –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã
‚îú‚îÄ‚îÄ manual_test_readme.md # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
‚îî‚îÄ‚îÄ test_pipeline.py      # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã
```

## üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ —Å–µ—Ä–≤–∏—Å–∞
```bash
docker compose build <service_name>
docker compose up -d <service_name>
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
```bash
docker compose logs -f <service_name>
```

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞
```bash
docker compose down
```

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –í—Å–µ –≤–µ–∫—Ç–æ—Ä—ã –∏–º–µ—é—Ç —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å 10 (VECTOR_DIM=10)
- –ß–∞–Ω–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Ä–∞–∑–±–∏–≤–∞—é—Ç—Å—è –ø–æ 50 —Å–∏–º–≤–æ–ª–æ–≤ (CHUNK_SIZE=50)
- –ò–Ω–¥–µ–∫—Å –≤ OpenSearch –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è `docs`
- –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç –≤ –µ–¥–∏–Ω–æ–π Docker-—Å–µ—Ç–∏

---

**–°—Ç–∞—Ç—É—Å**: –¢–µ—Å—Ç–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã ‚úÖ

